<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Global - Cr√©dito de Custeio</title>
    <!-- Favicon e CSS originais -->
    <link href="assets/images/svg/favicon.svg" rel="icon" />
    <link href="assets/css/swap.css" rel="stylesheet" />
    <link href="assets/css/slick.css" rel="stylesheet" />
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/css/style.css" rel="stylesheet" />
    <link href="assets/css/media_query.css" rel="stylesheet" />
    <link href="assets/css/custom-popup.css" rel="stylesheet" />
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
      /* =========================
         Regras para exibir/ocultar steps
         ========================= */
      .step {
        display: none;
      }
      .step.active {
        display: block;
      }

      /* Formata√ß√£o do indicador de progresso */
      .progress-indicator {
        text-align: center;
        margin: 1.5rem 0;
        font-weight: bold;
        font-size: 1.1rem;
      }

      /* Espa√ßamento entre bot√µes de navega√ß√£o */
      .nav-buttons {
        margin-top: 2rem;
        display: flex;
        justify-content: space-between;
      }
      .obrigatorio-label::after {
        content: " (Obrigat√≥rio)";
        color: red;
        font-weight: normal;
        font-size: 0.85em;
      }
    </style>
  </head>
  <body>
    <div class="site_content">
      <!-- ====================================== Preloader ===================================== -->
      <div class="page-loader" id="page-loader">
        <img alt="logo" src="assets/images/svg/logo.svg" />
        <p class="loade-text" data-text="Global">Global</p>
      </div>
      <!-- ====================================== Header ===================================== -->
      <header class="site_lr-spacer back-with-text" id="top-navbar">
        <a href="javascript:history.go(-1)">
          <img
            alt="back-btn-top"
            class="nav-header back-btn"
            src="assets/images/svg/back-btn-top.svg"
          />
        </a>
        <div class="header-title">
          <h1>Solicita√ß√£o - Cr√©dito de Custeio</h1>
        </div>
      </header>
      <!-- ====================================== Wizard ‚ÄúColeta de Dados‚Äù ===================================== -->
      <section class="section-main section-main-ver site_lr-spacer">
        <!-- Indicador de progresso: Etapa X de 3 -->
        <div class="progress-indicator" id="progress-indicator">
          Etapa 1 de 6
        </div>
        <!-- In√≠cio do formul√°rio wizard -->
        <form id="upgradeForm">
          <!-- =========================
     Etapa 1: PRODUTOR RURAL
     ========================= -->
          <div class="step active" id="step-1">
            <div class="card shadow-sm">
              <div class="card-body">
                <h6 class="fw-semibold mb-4">Etapa 1: Produtor Rural</h6>
                <div class="row g-3">
                  <div class="col-12 mb-4">
                    <label for="valor_credito" class="form-label fw-semibold"
                      >Valor do Cr√©dito Desejado (R$)</label
                    >
                    <div class="d-flex align-items-center">
                      <input
                        type="range"
                        class="form-range me-3"
                        min="1000000"
                        max="100000000"
                        step="100000"
                        value="1000000"
                        id="valor_credito"
                        name="valor_credito"
                        oninput="atualizarValorCredito(this.value)"
                      />
                      <span id="valor_credito_exibido" class="fw-bold"
                        >R$ 1.000.000,00</span
                      >
                    </div>
                  </div>

                  <div class="col-12 mb-3">
                    <label class="form-label"> Produtor Rural </label>
                    <select
                      class="form-select"
                      id="produtor_tipo"
                      name="produtor_tipo"
                      required=""
                    >
                      <option selected="" value="">Selecione...</option>
                      <option value="PRONAF">PRONAF</option>
                      <option value="PRONAMP">PRONAMP</option>
                      <option value="Demais Produtores">
                        Demais Produtores
                      </option>
                    </select>
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label"> CPF/CNPJ </label>
                    <input
                      class="form-control"
                      id="cpf_cnpj"
                      name="cpf_cnpj"
                      placeholder="CPF ou CNPJ"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label"> Perfil do Produtor </label>
                    <input
                      class="form-control"
                      id="perfil_produtor"
                      name="perfil_produtor"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      Experi√™ncia na atividade principal (anos)
                    </label>
                    <input
                      class="form-control"
                      id="experiencia"
                      min="0"
                      name="experiencia"
                      required=""
                      type="number"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      Assist√™ncia T√©cnica Agropecu√°ria
                    </label>
                    <select
                      class="form-select"
                      id="assistencia_tecnica"
                      name="assistencia_tecnica"
                      required=""
                    >
                      <option selected="" value="">Selecione...</option>
                      <option>Sim: √ìrg√£o Estadual</option>
                      <option>Sim: Pr√≥pria</option>
                      <option>N√£o possui</option>
                    </select>
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      Desembolso anual manuten√ß√£o familiar (R$)
                    </label>
                    <input
                      class="form-control"
                      id="desembolso_familiar"
                      name="desembolso_familiar"
                      required=""
                      type="number"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      D√≠vidas a vencer pr√≥ximos 12 meses?
                    </label>
                    <input
                      class="form-control"
                      id="dividas_vencer"
                      name="dividas_vencer"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      D√≠vidas direto com fornecedores (R$)
                    </label>
                    <input
                      class="form-control"
                      id="dividas_fornecedores"
                      name="dividas_fornecedores"
                      required=""
                      type="number"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      Custeio normal de outras institui√ß√µes (R$)
                    </label>
                    <input
                      class="form-control"
                      id="custeio_outras"
                      name="custeio_outras"
                      required=""
                      type="number"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      Custeio prorrogado em outras institui√ß√µes (R$)
                    </label>
                    <input
                      class="form-control"
                      id="custeio_prorrogado"
                      name="custeio_prorrogado"
                      required=""
                      type="number"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      Investimento em outras institui√ß√µes (R$)
                    </label>
                    <input
                      class="form-control"
                      id="investimento_outras"
                      name="investimento_outras"
                      required=""
                      type="number"
                    />
                  </div>
                </div>
              </div>
            </div>
            <!-- Bot√µes de navega√ß√£o da Etapa 1 -->
            <div class="nav-buttons">
              <button class="btn btn-secondary" disabled="" type="button">
                Anterior
              </button>
              <button class="btn main-bg-color-btn" id="next-1" type="button">
                Pr√≥ximo
              </button>
            </div>
          </div>
          <!-- =========================
     Etapa 2: PROPRIEDADE RURAL
     ========================= -->
          <div class="step" id="step-2">
            <div class="card shadow-sm">
              <div class="card-body">
                <h6 class="fw-semibold mb-4">Etapa 2: Propriedade Rural</h6>
                <p class="mb-3">
                  Dados da propriedade
                  <strong> PRINCIPAL </strong>
                </p>
                <div class="row g-3">
                  <div class="col-md-6 mb-3">
                    <label class="form-label"> N√∫mero do CCIR </label>
                    <input
                      class="form-control"
                      id="numero_ccir"
                      name="numero_ccir"
                      placeholder="Digite o CCIR"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label"> Nome da propriedade </label>
                    <input
                      class="form-control"
                      id="nome_propriedade"
                      name="nome_propriedade"
                      placeholder="Nome da propriedade"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">
                      Munic√≠pio da propriedade rural / UF
                    </label>
                    <input
                      class="form-control"
                      id="municipio_propriedade"
                      name="municipio_propriedade"
                      placeholder="Munic√≠pio / UF"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label"> N√∫mero de matr√≠cula </label>
                    <input
                      class="form-control"
                      id="numero_matricula"
                      name="numero_matricula"
                      placeholder="N¬∫ de matr√≠cula"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      Existe aliena√ß√£o ou gravame que incide sobre a matr√≠cula?
                    </label>
                    <input
                      class="form-control"
                      id="alienacao_gravame"
                      name="alienacao_gravame"
                      placeholder="Sim/N√£o e detalhes"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-12 mb-3">
                    <label class="form-label">
                      Textura do solo predominante na √°rea explorada
                    </label>
                    <input
                      class="form-control"
                      id="textura_solo"
                      name="textura_solo"
                      placeholder="Ex: Argiloso, Arenoso, etc."
                      required=""
                      type="text"
                    />
                  </div>
                </div>
              </div>
            </div>
            <!-- Bot√µes de navega√ß√£o da Etapa 2 -->
            <div class="nav-buttons">
              <button class="btn btn-secondary" id="prev-2" type="button">
                Anterior
              </button>
              <button class="btn main-bg-color-btn" id="next-2" type="button">
                Pr√≥ximo
              </button>
            </div>
          </div>
          <!-- =========================
     Etapa 3: ATIVIDADE RURAL NAS PROPRIEDADES
     ========================= -->
          <div class="step" id="step-3">
            <div class="card shadow-sm">
              <div class="card-body">
                <h6 class="fw-semibold mb-4 obrigatorio-label">
                  Etapa 3: Atividade Rural nas Propriedades
                </h6>
                <p class="mb-3">
                  Qual atividade rural √© desempenhada nas propriedades
                </p>
                <div class="row g-3">
                  <div class="col-4">
                    <input
                      autocomplete="off"
                      class="btn-check"
                      id="atividade1"
                      name="atividade_props[]"
                      onclick="updateSelections()"
                      type="checkbox"
                      value="Cultura Anual"
                    />
                    <label class="btn btn-primary w-100" for="atividade1">
                      Cultura Anual
                    </label>
                  </div>
                  <div class="col-4">
                    <input
                      autocomplete="off"
                      class="btn-check"
                      id="atividade2"
                      name="atividade_props[]"
                      onclick="updateSelections()"
                      type="checkbox"
                      value="Cultura Perene"
                    />
                    <label class="btn btn-success w-100" for="atividade2">
                      Cultura Perene
                    </label>
                  </div>
                  <div class="col-4">
                    <input
                      autocomplete="off"
                      class="btn-check"
                      id="atividade3"
                      name="atividade_props[]"
                      onclick="updateSelections()"
                      type="checkbox"
                      value="Agricultura Geral"
                    />
                    <label class="btn btn-danger w-100" for="atividade3">
                      Agricultura Geral
                    </label>
                  </div>
                  <div class="col-4">
                    <input
                      autocomplete="off"
                      class="btn-check"
                      id="atividade4"
                      name="atividade_props[]"
                      onclick="updateSelections()"
                      type="checkbox"
                      value="Bovino de Corte"
                    />
                    <label class="btn btn-warning w-100" for="atividade4">
                      Bovino de Corte
                    </label>
                  </div>
                  <div class="col-4">
                    <input
                      autocomplete="off"
                      class="btn-check"
                      id="atividade5"
                      name="atividade_props[]"
                      onclick="updateSelections()"
                      type="checkbox"
                      value="Bovino de Leite"
                    />
                    <label class="btn btn-info w-100" for="atividade5">
                      Bovino de Leite
                    </label>
                  </div>
                  <div class="col-4">
                    <input
                      autocomplete="off"
                      class="btn-check"
                      id="atividade6"
                      name="atividade_props[]"
                      onclick="updateSelections()"
                      type="checkbox"
                      value="Pecu√°ria Geral"
                    />
                    <label class="btn btn-dark w-100" for="atividade6">
                      Pecu√°ria Geral
                    </label>
                  </div>
                </div>
                <!-- Se√ß√£o de sele√ß√µes -->
                <div class="mt-3">
                  <h6 class="fw-semibold">Atividades Selecionadas:</h6>
                  <ul class="list-group" id="selecaoAtividades">
                    <!-- As sele√ß√µes do usu√°rio aparecem aqui -->
                  </ul>
                </div>
              </div>
            </div>
            <!-- Bot√µes de navega√ß√£o da Etapa 3 -->
            <div class="nav-buttons">
              <button class="btn btn-secondary" id="prev-3" type="button">
                Anterior
              </button>
              <button class="btn main-bg-color-btn" id="next-3" type="button">
                Pr√≥ximo
              </button>
            </div>
          </div>
          <!-- =========================
     Etapa 4: Propriet√°rio do Im√≥vel
     ========================= -->
          <!-- =========================
   Etapa 4: Propriet√°rio do Im√≥vel
   ========================= -->
          <div class="step" id="step-4">
            <div class="card shadow-sm">
              <div class="card-body">
                <h6 class="fw-semibold mb-4">
                  Etapa 4: Propriet√°rio do Im√≥vel/Matr√≠cula
                </h6>
                <p class="mb-3">
                  Caso o produtor rural N√ÉO seja propriet√°rio do
                  im√≥vel/matr√≠cula, preencher os campos abaixo.
                </p>
                <div class="row g-3">
                  <div class="col-12">
                    <label class="form-label">
                      Nome ou Raz√£o Social do Propriet√°rio
                    </label>
                    <input
                      class="form-control"
                      id="nome_proprietario"
                      name="nome_proprietario"
                      placeholder="Nome ou Raz√£o Social"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-12">
                    <label class="form-label"> CPF/CNPJ </label>
                    <input
                      class="form-control"
                      id="cpf_cnpj_proprietario"
                      name="cpf_cnpj_proprietario"
                      placeholder="CPF ou CNPJ"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-12">
                    <label class="form-label">
                      Porcentagem de Propriedade (%)
                    </label>
                    <input
                      class="form-control"
                      id="percentual_propriedade"
                      max="100"
                      min="0"
                      name="percentual_propriedade"
                      placeholder="%"
                      required=""
                      type="number"
                    />
                  </div>
                  <div class="col-12">
                    <label class="form-label">
                      A propriedade possui contrato de
                      arrendamento/comodato/parceria/usufruto? Ou condi√ß√£o de
                      posseiro?
                    </label>
                    <input
                      class="form-control"
                      id="condicao_posseiro"
                      name="condicao_posseiro"
                      placeholder="Descreva a condi√ß√£o"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-12">
                    <label class="form-label"> Perfil </label>
                    <input
                      class="form-control"
                      id="perfil"
                      name="perfil"
                      placeholder="Perfil"
                      required=""
                      type="text"
                    />
                  </div>
                  <div class="col-12">
                    <label class="form-label">
                      Tamanho da √°rea no contrato (ha)
                    </label>
                    <input
                      class="form-control"
                      id="tamanho_area_contrato"
                      name="tamanho_area_contrato"
                      placeholder="Tamanho da √°rea"
                      required=""
                      step="0.01"
                      type="number"
                    />
                  </div>
                  <div class="col-12">
                    <label class="form-label"> Vencimento do contrato </label>
                    <input
                      class="form-control"
                      id="vencimento_contrato"
                      name="vencimento_contrato"
                      required=""
                      type="date"
                    />
                  </div>
                  <div class="col-12">
                    <label class="form-label"> Valor do contrato (R$) </label>
                    <input
                      class="form-control"
                      id="valor_contrato"
                      name="valor_contrato"
                      placeholder="Valor do contrato"
                      required=""
                      step="0.01"
                      type="number"
                    />
                  </div>
                </div>
              </div>
            </div>
            <!-- Bot√µes de navega√ß√£o da Etapa 4 -->
            <div class="nav-buttons">
              <button class="btn btn-secondary" id="prev-4" type="button">
                Anterior
              </button>
              <button class="btn main-bg-color-btn" id="next-4" type="button">
                Pr√≥ximo
              </button>
            </div>
          </div>
          <div class="step" id="step-5">
            <div class="card shadow-sm">
              <div class="card-body">
                <h6 class="fw-semibold mb-4">
                  Etapa 5: Propriedades Secund√°rias
                </h6>
                <p class="mb-3 obrigatorio-label">
                  Selecione quantas propriedades secund√°rias deseja cadastrar:
                </p>
                <select
                  class="form-select mb-4"
                  id="num_secundarias"
                  onchange="renderSecundarias(this.value)"
                >
                  <option value="">Selecione...</option>
                  <option value="0">0 propriedade</option>
                  <option value="1">1 propriedade</option>
                  <option value="2">2 propriedades</option>
                  <option value="3">3 propriedades</option>
                  <option value="4">4 propriedades</option>
                  <option value="5">5 propriedades</option>
                  <option value="6">6 propriedade</option>
                  <option value="7">7 propriedades</option>
                  <option value="8">8 propriedades</option>
                  <option value="9">9 propriedades</option>
                  <option value="10">10 propriedades</option>
                </select>
                <div id="secundariasContainer"></div>
              </div>
            </div>
            <div class="nav-buttons">
              <button class="btn btn-secondary" id="prev-5" type="button">
                Anterior
              </button>
              <button class="btn main-bg-color-btn" id="next-5" type="button">
                Pr√≥ximo
              </button>
            </div>
          </div>
          <!-- =========================
     Etapa 6: Autoriza√ß√£o
     ========================= -->
          <div class="step" id="step-6">
            <div class="card shadow-sm">
              <div class="card-body">
                <h6 class="fw-semibold mb-4">
                  Etapa 6: Autoriza√ß√£o e Declara√ß√µes
                </h6>

                <div class="mb-3">
                  <p class="form-text small">
                    Autorizo, nos termos da Resolu√ß√£o CMN n¬∫ 3.658 de
                    17.12.2008, a <strong>GLOBAL</strong> a consultar as
                    informa√ß√µes consolidadas, relativas √† minha pessoa ou √†
                    empresa e seus s√≥cios, se for o caso, constantes no Sistema
                    de Informa√ß√µes de Cr√©ditos (SCR) do BACEN.
                  </p>
                  <p class="form-text small">
                    Autorizo, ainda, a GLOBAL a fornecer informa√ß√µes sobre as
                    opera√ß√µes de cr√©dito com ela realizadas, no sentido de
                    compor o cadastro do citado sistema. Os presentes dados s√£o
                    verdadeiros e visam facilitar os processos de negocia√ß√£o e
                    transa√ß√µes comerciais, pela antecipa√ß√£o de informa√ß√µes a meu
                    respeito.
                  </p>
                  <p class="form-text small">
                    Autorizo o arquivamento dos meus dados pessoais e de
                    idoneidade na <strong>SERASA</strong> - Centraliza√ß√£o de
                    Servi√ßos dos Bancos S/A, que poder√° deles se utilizar,
                    respeitadas as disposi√ß√µes legais em vigor. Para os devidos
                    fins de direito, declaro(amos) respons√°vel(eis) pela
                    veracidade das informa√ß√µes prestadas neste formul√°rio e
                    autorizamos sua confirma√ß√£o.
                  </p>
                  <p class="form-text small">
                    Declaro que:<br />
                    ‚Ä¢ as informa√ß√µes por mim prestadas sobre renda/faturamento e
                    patrim√¥nio s√£o l√≠citas;<br />
                    ‚Ä¢ tenho ci√™ncia da Lei n¬∫ 9.613/98, que disp√µe sobre os
                    crimes de ‚Äúlavagem‚Äù ou oculta√ß√£o de bens, direitos e
                    valores, com as altera√ß√µes introduzidas, e dos arts. 297,
                    298 e 299 do C√≥digo Penal;<br />
                    ‚Ä¢ estou ciente de que a falsidade dos dados declarados
                    configura crime previsto na legisla√ß√£o brasileira, pass√≠vel
                    de responsabiliza√ß√£o civil, criminal e administrativa,
                    podendo implicar na imediata revoga√ß√£o das avalia√ß√µes de
                    risco de cr√©dito, das opera√ß√µes avaliadas e n√£o contratadas
                    e do vencimento antecipado das opera√ß√µes de cr√©dito vigentes
                    vinculadas a tais dados.
                  </p>
                </div>

                <div class="form-check mt-4">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="aceite_final"
                    required
                  />
                  <label class="form-check-label" for="aceite_final">
                    Declaro que li e aceito os termos acima.
                  </label>
                </div>
              </div>
            </div>

            <div class="nav-buttons mt-3">
              <button class="btn btn-secondary" type="button" id="prev-6">
                Anterior
              </button>
              <button
                class="btn btn-success"
                id="enviarFormulario"
                type="button"
              >
                Enviar Formul√°rio
              </button>
            </div>
          </div>
        </form>
      </section>
    </div>
    <!-- ====================================== Scripts ===================================== -->
    <script src="assets/javascript/jquery.js"></script>
    <script src="assets/javascript/slick.min.js"></script>
    <script src="assets/javascript/bootstrap.min.js"></script>
    <script src="assets/javascript/script.js"></script>
    <script src="assets/javascript/custom-popup.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <!-- Script de autentica√ß√£o -->
    <script src="assets/js/auth.js"></script>
    <!-- =========================
       JavaScript para controlar a navega√ß√£o entre steps
       ========================= -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const steps = document.querySelectorAll(".step");
        const progressIndicator = document.getElementById("progress-indicator");

        let currentStep = 0; // index de steps (0 => step-1, 1 => step-2, 2 => step-3, 3 => step-4)

        // Fun√ß√£o para exibir somente o step ‚Äúindex‚Äù e atualizar indicador
        function showStep(index) {
          steps.forEach((stepDiv, i) => {
            if (i === index) {
              stepDiv.classList.add("active");
            } else {
              stepDiv.classList.remove("active");
            }
          });
          progressIndicator.textContent = `Etapa ${index + 1} de ${
            steps.length
          }`;
          currentStep = index;
        }

        // Bot√£o ‚ÄúPr√≥ximo‚Äù da Etapa 1
        document.getElementById("next-1").addEventListener("click", () => {
          // Aqui voc√™ pode validar campos de step 1 antes de avan√ßar, se desejar
          showStep(1);
        });

        // Bot√£o ‚ÄúPr√≥ximo‚Äù da Etapa 2
        document.getElementById("next-2").addEventListener("click", () => {
          // Aqui voc√™ pode validar campos de step 2 antes de avan√ßar, se desejar
          showStep(2);
        });

        // Bot√£o ‚ÄúPr√≥ximo‚Äù da Etapa 3
        document.getElementById("next-3").addEventListener("click", () => {
          const selecionadas = document.querySelectorAll(
            'input[name="atividade_props[]"]:checked'
          );
          if (selecionadas.length === 0) {
            alert("Por favor, selecione pelo menos uma atividade rural.");
            return;
          }
          showStep(3); // Avan√ßar para Etapa 4
        });

        // Bot√£o ‚ÄúAnterior‚Äù da Etapa 2
        document.getElementById("prev-2").addEventListener("click", () => {
          showStep(0);
        });

        // Bot√£o ‚ÄúAnterior‚Äù da Etapa 3
        document.getElementById("prev-3").addEventListener("click", () => {
          showStep(1);
        });

        // Bot√£o ‚ÄúAnterior‚Äù da Etapa 4
        document.getElementById("prev-4").addEventListener("click", () => {
          showStep(2);
        });
        // Bot√£o ‚ÄúPr√≥ximo‚Äù da Etapa 4
        document.getElementById("next-4").addEventListener("click", () => {
          showStep(4); // Avan√ßar para a Etapa 5
        });
        // Bot√£o ‚ÄúAnterior‚Äù da Etapa 5
        document.getElementById("prev-5").addEventListener("click", () => {
          showStep(3); // Voltar para a Etapa 4
        });
        document.getElementById("next-5").addEventListener("click", () => {
          const quantidade = parseInt(
            document.getElementById("num_secundarias").value
          );

          if (isNaN(quantidade)) {
            alert(
              "Por favor, selecione a quantidade de propriedades secund√°rias."
            );
            return;
          }

          if (quantidade === 0) {
            showStep(5); // Avan√ßa direto se n√£o tiver propriedades secund√°rias
            return;
          }

          let valid = true;
          for (let i = 1; i <= quantidade; i++) {
            const select = document.querySelector(
              `[name="secundaria_proprietario_${i}"]`
            );
            if (!select || select.value === "") {
              valid = false;
            }
          }

          if (!valid) {
            alert(
              'Preencha o campo "Voc√™ √© o propriet√°rio?" para todas as propriedades secund√°rias.'
            );
            return;
          }

          showStep(5); // Avan√ßar para Etapa 6
        });

        document
          .getElementById("prev-6")
          .addEventListener("click", () => showStep(4));
        // Bot√£o ‚ÄúFinalizar‚Äù da Etapa 4
        document.getElementById("finish").addEventListener("click", () => {
          // Se quiser submeter o formul√°rio, use:
          // document.getElementById("upgradeForm").submit();
          //
          // No exemplo anterior, havia um link ‚ÄúContinue‚Äù para paymentMethod.html.
          // Caso queira apenas redirecionar para a pr√≥xima p√°gina, use:
          window.location.href = "paymentMethod.html"; // Redireciona para outra p√°gina (se necess√°rio)
        });
      });
    </script>
    <script>
      function updateSelections() {
        // Pega todos os checkboxes e o elemento da lista
        const checkboxes = document.querySelectorAll(
          'input[type="checkbox"]:checked'
        );
        const selecaoAtividades = document.getElementById("selecaoAtividades");

        // Limpa as sele√ß√µes anteriores
        selecaoAtividades.innerHTML = "";

        // Para cada checkbox marcado, adiciona uma lista com o valor da atividade
        checkboxes.forEach((checkbox) => {
          const listItem = document.createElement("li");
          listItem.classList.add("list-group-item");
          listItem.textContent = checkbox.value;
          selecaoAtividades.appendChild(listItem);
        });
      }
    </script>
    <script>
      function renderSecundarias(qtd) {
        const container = document.getElementById("secundariasContainer");
        container.innerHTML = "";
        for (let i = 1; i <= qtd; i++) {
          container.innerHTML += `
      <div class="border p-3 mb-4">
        <h6 class="fw-bold mb-3">Propriedade Secund√°ria ${i}</h6>
        <div class="mb-3">
          <label class="form-label">Nome da Propriedade</label>
          <input type="text" class="form-control" name="secundaria_nome_${i}" required />
        </div>
        <div class="mb-3">
          <label class="form-label">Munic√≠pio / UF</label>
          <input type="text" class="form-control" name="secundaria_municipio_${i}" required />
        </div>
        <div class="mb-3">
          <label class="form-label">N√∫mero de matr√≠cula</label>
          <input type="text" class="form-control" name="secundaria_matricula_${i}" required />
        </div>
        <div class="mb-3">
          <label class="form-label">√Årea utilizada (ha)</label>
          <input type="number" step="0.01" class="form-control" name="secundaria_area_${i}" required />
        </div>
        <div class="mb-3 obrigatorio-label">
          <label class="form-label">Voc√™ √© o propriet√°rio?</label>
          <select class="form-select" name="secundaria_proprietario_${i}" onchange="toggleProprietarioExtras(this, ${i})" required>
            <option value="">Selecione...</option>
            <option value="Sim">Sim</option>
            <option value="N√£o">N√£o</option>
          </select>
        </div>
        <div id="extras_${i}" style="display:none;">
          <div class="mb-3">
            <label class="form-label">Nome ou Raz√£o Social do Propriet√°rio</label>
            <input type="text" class="form-control" name="secundaria_nome_proprietario_${i}" />
          </div>
          <div class="mb-3">
            <label class="form-label">CPF/CNPJ</label>
            <input type="text" class="form-control" name="secundaria_cpf_cnpj_${i}" />
          </div>
          <div class="mb-3">
            <label class="form-label">Percentual de Propriedade (%)</label>
            <input type="number" class="form-control" name="secundaria_percentual_${i}" />
          </div>
        </div>
      </div>
    `;
        }
      }

      function toggleProprietarioExtras(select, index) {
        const extras = document.getElementById("extras_" + index);
        if (select.value === "N√£o") {
          extras.style.display = "block";
        } else {
          extras.style.display = "none";
        }
      }

      function atualizarValorCredito(valor) {
        const exibido = document.getElementById("valor_credito_exibido");
        const valorFormatado = Number(valor).toLocaleString("pt-BR", {
          style: "currency",
          currency: "BRL",
          minimumFractionDigits: 2,
        });
        exibido.textContent = valorFormatado;
      }
    </script>
    <!-- Modal de Aviso -->
    <div
      class="modal fade"
      id="avisoModal"
      tabindex="-1"
      aria-labelledby="avisoLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="font-family: Arial, sans-serif">
          <div class="modal-header" style="background-color: #f0f8ff">
            <h5 class="modal-title" id="avisoLabel" style="color: #007bff">
              üì¢ Aviso Importante
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Fechar"
            ></button>
          </div>
          <div class="modal-body" style="background-color: #f0f8ff">
            <p>
              Preencha o m√°ximo de informa√ß√µes que voc√™ tiver em m√£os no
              momento.
            </p>
            <p>
              Caso n√£o tenha acesso a todos os dados agora, n√£o se preocupe ‚Äî
              ser√° poss√≠vel
              <strong
                >editar, complementar e atualizar sua solicita√ß√£o
                posteriormente</strong
              >.
            </p>
            <p>
              Al√©m disso, nossa equipe entrar√° em contato com voc√™ para
              <strong>ajudar no preenchimento completo</strong> e esclarecer
              <strong>qualquer d√∫vida</strong> que voc√™ tiver durante o
              processo.
            </p>
          </div>
          <div class="modal-footer" style="background-color: #f0f8ff">
            <button
              type="button"
              class="btn btn-primary"
              data-bs-dismiss="modal"
            >
              Entendi
            </button>
          </div>
        </div>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const avisoModal = new bootstrap.Modal(
          document.getElementById("avisoModal")
        );
        avisoModal.show();
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        firebase.auth().onAuthStateChanged(function (user) {
          if (!user) {
            alert("Voc√™ precisa estar logado para enviar a solicita√ß√£o.");
            window.location.href = "sign-in.html";
            return;
          }

          const form = document.getElementById("upgradeForm");
          const btnEnviar = document.getElementById("enviarFormulario");

          btnEnviar.addEventListener("click", async function (e) {
            e.preventDefault();

            // Estado "carregando"
            btnEnviar.innerHTML =
              'Enviando... <span class="spinner-border spinner-border-sm ms-1" role="status" aria-hidden="true"></span>';
            btnEnviar.disabled = true;

            const formData = new FormData(form);
            const dados = {};

            formData.forEach((valor, chave) => {
              if (dados[chave]) {
                if (!Array.isArray(dados[chave])) {
                  dados[chave] = [dados[chave]];
                }
                dados[chave].push(valor);
              } else {
                dados[chave] = valor;
              }
            });

            // Adiciona os campos fixos
            dados.status = "inactive";
            dados.status_documentacao = "pendente";
            dados.status_solicitacao = "aguardando";
            dados.createdAt = firebase.firestore.Timestamp.now();
            dados.cliente_id = user.uid;
            dados.addedBy = user.email;

            try {
              await firebase.firestore().collection("custeio").add(dados);

              // Pop-up bonito
              Swal.fire({
                icon: "success",
                title: "Solicita√ß√£o enviada com sucesso!",
                html: `Agora √© hora de <strong>concluir sua solicita√ß√£o</strong> com os documentos e informa√ß√µes necess√°rias.<br><br>
                   Nossa equipe ir√° acompanhar tudo de perto para garantir a aprova√ß√£o do seu cr√©dito junto aos nossos bancos parceiros.`,
                confirmButtonText: "Entendi!",
                confirmButtonColor: "#198754",
              }).then(() => {
                window.location.href = "solicitacoes.html";
              });
            } catch (err) {
              console.error("Erro ao gravar no Firestore:", err);
              alert("Erro ao enviar. Tente novamente.");
              btnEnviar.innerHTML = "Enviar Formul√°rio";
              btnEnviar.disabled = false;
            }
          });
        });
      });
    </script>
  </body>
</html>
