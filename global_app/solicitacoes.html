<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Global - Crédito</title>
    <link href="assets/images/svg/favicon.svg" rel="icon" />
    <link href="assets/css/swap.css" rel="stylesheet" />
    <link href="assets/css/slick.css" rel="stylesheet" />
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/css/style.css" rel="stylesheet" />
    <link href="assets/css/media_query.css" rel="stylesheet" />
    <link href="assets/css/custom-popup.css" rel="stylesheet" />

    <style>
      /* Espaçamento principal da área */
      .wrapper {
        padding: 48px 24px 96px;
      }

      /* Grid responsivo para os cards */
      .card-wrapper {
        display: grid;
        grid-template-columns: 1fr;
        gap: 16px;
      }

      @media (min-width: 480px) {
        .card-wrapper {
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }
      }

      /* Card com fundo imagem e sombra */
      .custom-card {
        background-image: url("assets/images/card.jpg");
        background-size: cover;
        background-position: center;
        border: none;
        border-radius: 20px;
        padding: 20px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
        color: #fff;
        font-family: "Segoe UI", sans-serif;
        position: relative;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        transform-style: preserve-3d;
        backdrop-filter: blur(5px);
        min-height: 180px;
        box-sizing: border-box;
      }

      .custom-card:hover {
        transform: scale(1.03);
        box-shadow: 0 12px 28px rgba(0, 0, 0, 0.7);
      }

      /* Garante que nenhum conteúdo ultrapasse o card */
      .custom-card * {
        max-width: 100%;
        box-sizing: border-box;
        word-wrap: break-word;
        overflow-wrap: break-word;
      }

      .card-content {
        position: relative;
        z-index: 1;
      }

      .card-columns {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      @media (min-width: 480px) {
        .card-columns {
          flex-direction: row;
          justify-content: space-between;
        }
      }

      .card-column {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      .card-column h4 {
        margin: 0;
        font-size: 12px;
        color: #ccc;
        text-transform: uppercase;
        border-bottom: 1px solid rgba(255, 255, 255, 0.15);
        padding-bottom: 4px;
      }

      .card-column p {
        margin: 0;
        font-size: 15px;
        font-weight: 500;
        color: #f5f5f5;
      }

      .btn-edit {
        font-size: 13px;
        color: #00d4ff;
        text-decoration: underline;
        cursor: pointer;
        align-self: flex-start;
      }

      /* Ajustes para botões e textos longos */
      .custom-card button,
      .custom-card .btn,
      .custom-card h1,
      .custom-card h2,
      .custom-card h3,
      .custom-card h4,
      .custom-card span,
      .custom-card p {
        word-break: break-word;
        white-space: normal;
        text-align: left;
      }

      /* Ajuste para telas muito pequenas */
      @media (max-width: 360px) {
        .custom-card {
          padding: 16px;
          font-size: 14px;
        }

        .custom-card .btn,
        .custom-card button {
          font-size: 13px;
          padding: 8px;
        }
      }

      /* Navbar fixa no rodapé */
      .nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 999;
        background: #fff;
        box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
      }

      /* ========= NOVOS ESTILOS ========= */

      /* Topo do card com logo, data e valor */
      .card-header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 16px;
      }

      .card-logo img {
        height: 45px;
      }

      .card-title-valor h4 {
        margin: 0;
        font-size: 12px;
        color: #aaa;
        text-transform: uppercase;
      }

      .card-title-valor p {
        margin: 2px 0;
        font-size: 18px;
        color: #fff;
        font-weight: bold;
        background-color: #198754;
        padding: 4px 10px;
        border-radius: 5px;
      }

      .card-data p {
        margin: 0;
        font-size: 13px;
        color: #ccc;
        text-align: right;
      }

      /* Layout em coluna em telas pequenas */
      @media (max-width: 480px) {
        .card-header-top {
          flex-direction: column;
          align-items: flex-start;
        }

        .card-data p {
          text-align: left;
        }

        .card-logo {
          margin-bottom: 4px;
        }
      }

      /* Elimina qualquer margem superior dos cards */
      .container.mt-0 {
        margin-top: 0px !important;
        padding-top: 0 !important;
      }
    </style>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />
  </head>
  <body>
    <div class="site_content">
      <!-- ====================================== Preloader ===================================== -->
      <div class="page-loader" id="page-loader">
        <img alt="logo" src="assets/images/svg/logo.svg" />
        <p class="loade-text" data-text="Crédito">Crédito</p>
      </div>
      <!-- ====================================== Header ===================================== -->
      <header
        class="site_lr-spacer homeHeader-main d-flex justify-content-between align-items-center"
        id="top-navbar"
      >
        <div class="d-flex align-items-center">
          <a href="homeScreen.html">
            <img
              alt="homeLogo"
              class="nav-header"
              src="assets/images/svg/homeLogo.png"
              style="height: 30px"
            />
          </a>
        </div>

        <div class="homeHeader d-flex align-items-center gap-2">
          <span id="welcome-message">Carregando...</span>
          <a href="notification.html">
            <img
              alt="buttonNotification"
              src="assets/images/svg/buttonNotification.svg"
            />
          </a>
          <a
            aria-controls="offcanvasExample"
            data-bs-toggle="offcanvas"
            href="#offcanvasExample"
          >
            <img
              alt="buttonSettings"
              src="assets/images/svg/buttonSettings.svg"
            />
          </a>
        </div>
      </header>
      <!-- ====================================== AI Voices Screen Start ===================================== -->
      <section class="section-main section-main-ver">
        <h2 class="d-none">hidden</h2>
        <div class="language-select">
          <div class="tab-btn-main mt-0" id="ongoing">
            <a
              class="ongoing tab-active"
              data-tab="one"
              href="javascript:void(0);"
              >Solicitações de Crédito</a
            >
            <a class="ongoing" data-tab="two" href="javascript:void(0);"
              >Crédito Aprovado</a
            >
            <div class="clear"></div>
          </div>
          <div class="container mt-0">
            <div class="wrapper">
              <div class="card-wrapper" id="cardsContainer">
                <p>Carregando solicitações...</p>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- ====================================== Setting Section ===================================== -->
      <section class="setting-section">
        <div
          aria-labelledby="offcanvasExampleLabel"
          class="offcanvas offcanvas-start"
          id="offcanvasExample"
          tabindex="-1"
        >
          <div class="offcanvas-header">
            <h2 class="offcanvas-title" id="offcanvasExampleLabel">Settings</h2>
            <button
              aria-label="Close"
              class="btn-close"
              data-bs-dismiss="offcanvas"
              type="button"
            ></button>
          </div>
          <div class="offcanvas-body">
            <a class="home-setting-icons-main" href="security.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img alt="security" src="assets/images/svg/security.svg" />
                </div>
                <h2 class="new-notification">Security</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="marketingPreferences.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img
                    alt="marketing-icon"
                    src="assets/images/svg/marketing-icon.svg"
                  />
                </div>
                <h2 class="new-notification">Marketing Preferences</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="notificationSettings.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img
                    alt="notificationOption"
                    src="assets/images/svg/notificationOption.svg"
                  />
                </div>
                <h2 class="new-notification">Notification Settings</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="language.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img
                    alt="language-icon"
                    src="assets/images/svg/language-icon.svg"
                  />
                </div>
                <h2 class="new-notification">Language</h2>
              </div>
              <p class="version">English (US)</p>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="faq.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img alt="faqs-icon" src="assets/images/svg/faqs-icon.svg" />
                </div>
                <h2 class="new-notification">FAQs</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="dataPrivacy.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img
                    alt="dataPrivacy-icon"
                    src="assets/images/svg/dataPrivacy-icon.svg"
                  />
                </div>
                <h2 class="new-notification">Data &amp; Privacy Policy</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="about.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img
                    alt="aboutVoice"
                    src="assets/images/svg/aboutVoice.svg"
                  />
                </div>
                <h2 class="new-notification">About WEvoice</h2>
              </div>
              <p class="version">v1.0.1</p>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="feedback.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img
                    alt="feedback-icon"
                    src="assets/images/svg/feedback-icon.svg"
                  />
                </div>
                <h2 class="new-notification">Send Feedback</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="contactUs.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img
                    alt="contactUs-icon"
                    src="assets/images/svg/contactUs-icon.svg"
                  />
                </div>
                <h2 class="new-notification">Contact Us</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="inviteFriends.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main">
                  <img
                    alt="inviteFriend-icon"
                    src="assets/images/svg/inviteFriend-icon.svg"
                  />
                </div>
                <h2 class="new-notification">Invite Friends</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main" href="deleteDeactivate.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main setting-icons-main2">
                  <img
                    alt="close-setting-icon"
                    src="assets/images/svg/close-setting-icon.svg"
                  />
                </div>
                <h2 class="new-notification">Delete or Deactivate Account</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
            <a class="home-setting-icons-main mb-0" href="logout.html">
              <div class="setting-opestion-main">
                <div class="setting-icons-main setting-icons-main2">
                  <img
                    alt="logOut-icon"
                    src="assets/images/svg/logOut-icon.svg"
                  />
                </div>
                <h2 class="new-notification">Logout</h2>
              </div>
              <img
                alt="right-half-arrow-black"
                class="setting-arrow"
                src="assets/images/svg/right-half-arrow-black.svg"
              />
            </a>
          </div>
        </div>
      </section>
      <!-- ====================================== Footer ===================================== -->
      <div class="nav">
        <a class="nav-item" href="homeScreen.html">
          <svg
            class="material-icons"
            fill="none"
            height="24"
            viewbox="0 0 24 24"
            width="24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M9.02 2.84001L3.63 7.04001C2.73 7.74001 2 9.23001 2 10.36V17.77C2 20.09 3.89 21.99 6.21 21.99H17.79C20.11 21.99 22 20.09 22 17.78V10.5C22 9.29001 21.19 7.74001 20.2 7.05001L14.02 2.72001C12.62 1.74001 10.37 1.79001 9.02 2.84001Z"
              stroke="#0F0F0F"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
            ></path>
            <path
              d="M12 17.99V14.99"
              opacity="0.34"
              stroke="#0F0F0F"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
            ></path>
          </svg>
          <span class="nav-text">Home</span>
        </a>
        <a class="nav-item active" href="solicitacoes.html">
          <svg
            class="material-icons"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
          >
            <path
              d="M16 2H8C6.89543 2 6 2.89543 6 4V20C6 21.1046 6.89543 22 8 22H16C17.1046 22 18 21.1046 18 20V4C18 2.89543 17.1046 2 16 2Z"
              stroke="#6218FF"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M9 8H15"
              stroke="#6218FF"
              stroke-width="2"
              stroke-linecap="round"
            />
            <path
              d="M9 12H15"
              stroke="#6218FF"
              stroke-width="2"
              stroke-linecap="round"
            />
            <path
              d="M9 16H13"
              stroke="#6218FF"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
          <span class="nav-text">Crédito</span>
        </a>

        <a class="nav-item" href="myWork.html">
          <svg
            class="material-icons"
            fill="none"
            height="24"
            viewbox="0 0 24 24"
            width="24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M21.6698 14.3L21.2698 19.3C21.1198 20.83 20.9998 22 18.2898 22H5.70977C2.99977 22 2.87977 20.83 2.72977 19.3L2.32977 14.3C2.24977 13.47 2.50977 12.7 2.97977 12.11C2.98977 12.1 2.98977 12.1 2.99977 12.09C3.54977 11.42 4.37977 11 5.30977 11H18.6898C19.6198 11 20.4398 11.42 20.9798 12.07C20.9898 12.08 20.9998 12.09 20.9998 12.1C21.4898 12.69 21.7598 13.46 21.6698 14.3Z"
              stroke="#0F0F0F"
              stroke-miterlimit="10"
              stroke-width="2"
            ></path>
            <path
              d="M3.5 11.4303V6.28027C3.5 2.88027 4.35 2.03027 7.75 2.03027H9.02C10.29 2.03027 10.58 2.41027 11.06 3.05027L12.33 4.75027C12.65 5.17027 12.84 5.43027 13.69 5.43027H16.24C19.64 5.43027 20.49 6.28027 20.49 9.68027V11.4703"
              opacity="0.4"
              stroke="#0F0F0F"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-miterlimit="10"
              stroke-width="2"
            ></path>
            <path
              d="M9.42969 17H14.5697"
              opacity="0.4"
              stroke="#0F0F0F"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-miterlimit="10"
              stroke-width="2"
            ></path>
          </svg>
          <span class="nav-text">My Work</span>
        </a>
        <a class="nav-item" href="account.html">
          <svg
            class="material-icons person-icon"
            fill="none"
            height="24"
            viewbox="0 0 24 24"
            width="24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M18.1404 21.6198C17.2604 21.8798 16.2204 21.9998 15.0004 21.9998H9.00035C7.78035 21.9998 6.74035 21.8798 5.86035 21.6198C6.08035 19.0198 8.75035 16.9697 12.0004 16.9697C15.2504 16.9697 17.9204 19.0198 18.1404 21.6198Z"
              opacity="0.4"
              stroke="#0F0F0F"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
            ></path>
            <path
              d="M22 9V15C22 18.78 20.86 20.85 18.14 21.62C17.26 21.88 16.22 22 15 22H9C7.78 22 6.74 21.88 5.86 21.62C3.14 20.85 2 18.78 2 15V9C2 4 4 2 9 2H15C20 2 22 4 22 9Z"
              stroke="#0F0F0F"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
            ></path>
            <path
              d="M15.5799 10.58C15.5799 12.56 13.9799 14.17 11.9999 14.17C10.0199 14.17 8.41992 12.56 8.41992 10.58C8.41992 8.60002 10.0199 7 11.9999 7C13.9799 7 15.5799 8.60002 15.5799 10.58Z"
              opacity="0.4"
              stroke="#0F0F0F"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
            ></path>
          </svg>
          <span class="nav-text">Account</span>
        </a>
      </div>
    </div>
    <script src="assets/javascript/jquery.js"></script>
    <script src="assets/javascript/slick.min.js"></script>
    <script src="assets/javascript/bootstrap.min.js"></script>
    <script src="assets/javascript/audio-song-play.js"></script>
    <script src="assets/javascript/script.js"></script>
    <script src="assets/javascript/custom-popup.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="assets/js/auth.js"></script>
    <!-- Script de autenticação -->

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const db = firebase.firestore();
        const auth = firebase.auth();
        const cardsContainer = document.getElementById("cardsContainer");
        let todasSolicitacoes = [];
        const nomesUsuarios = {};

        async function carregarUsuarios() {
          const colecoes = ["gerentes", "agentes"];
          for (const colecao of colecoes) {
            const snap = await db.collection(colecao).get();
            snap.forEach((doc) => {
              nomesUsuarios[doc.id] =
                doc.data().nome_completo || "Não informado";
            });
          }
        }

        auth.onAuthStateChanged(async (user) => {
          if (!user) {
            cardsContainer.innerHTML = `<div>Você precisa estar logado para ver as solicitações.</div>`;
            return;
          }

          document.getElementById("welcome-message").textContent =
            user.displayName || "";

          try {
            await carregarUsuarios();

            const snapshot = await db
              .collection("custeio")
              .where("cliente_id", "==", user.uid)
              .get();

            if (snapshot.empty) {
              cardsContainer.innerHTML = `<div>Nenhuma solicitação encontrada</div>`;
              return;
            }

            todasSolicitacoes = snapshot.docs.map((doc) => {
              const data = doc.data();
              data.id = doc.id; // agora cada 'data' tem o id do doc
              return data;
            });
            document.querySelector('[data-tab="one"]').click();
          } catch (e) {
            console.error("Erro ao carregar dados:", e);
            cardsContainer.innerHTML = `<div>Erro ao carregar solicitações.</div>`;
          }
        });

        function renderizarCards(lista) {
          cardsContainer.innerHTML = "";

          lista.forEach((data) => {
            const status = (
              data.status_solicitacao || "aguardando"
            ).toLowerCase();
            const isAprovadoOuConcluido =
              status === "concluido" || status === "aprovado";

            let statusColor = "#6c757d";
            switch (status) {
              case "processando":
                statusColor = "#0d6efd";
                break;
              case "aprovado":
                statusColor = "#198754";
                break;
              case "não aprovado":
              case "nao aprovado":
                statusColor = "#dc3545";
                break;
              case "concluído":
              case "concluido":
                statusColor = "#0dcaf0";
                break;
            }

            const gerente =
              nomesUsuarios[data.responsavelGerenteId] || "Não informado";
            const agente =
              nomesUsuarios[data.responsavelSecundarioId] || "Não informado";

            const card = document.createElement("div");
            card.className = "custom-card";

            if (isAprovadoOuConcluido) {
              card.innerHTML = `
                      <div class="card-content" style="position: relative; background-image: url('assets/images/card.jpg'); background-size: cover; background-position: center; border-radius: 20px; padding: 24px;">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); border-radius: 20px;"></div>
                        <div style="position: relative; z-index: 1;">

                          <div class="card-header-top" style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 12px;">
                            <div class="card-logo" style="display: flex; flex-direction: column;">
                              <img src="assets/images/svg/homeLogo.png" alt="Logo" style="max-height: 40px;" />
                              <div style="display: flex; flex-direction: row; gap: 16px; margin-top: 8px;">
                                <div style="font-size: 12px; color: #ccc;"><strong>Concluído:</strong><br />${
                                  data.data_conclusao
                                    ? new Date(
                                        typeof data.data_conclusao === "string"
                                          ? data.data_conclusao
                                          : data.data_conclusao.seconds * 1000
                                      ).toLocaleDateString("pt-BR")
                                    : "-"
                                }</div>
                                <div style="font-size: 12px; color: #ccc;"><strong>Criado:</strong><br />${
                                  data.createdAt
                                    ? new Date(
                                        data.createdAt.seconds * 1000
                                      ).toLocaleDateString("pt-BR")
                                    : "-"
                                }</div>
                              </div>
                            </div>
                            <div class="card-title-valor" style="margin-left: auto; text-align: right;">
                              <h4 style="color: #ccc; margin-bottom: 4px;">CRÉDITO DE CUSTEIO</h4>
                              <p style="background-color: #198754; padding: 4px 10px; border-radius: 5px; font-weight: bold;">
                                R$ ${Number(
                                  data.valor_credito || 0
                                ).toLocaleString("pt-BR", {
                                  minimumFractionDigits: 2,
                                })}
                              </p>
                            </div>
                          </div>

                          <div class="card-columns" style="margin: 16px 0 8px;">
                            <div class="card-column">
                              <h4 style="color: #ccc;">Gerente</h4>
                              <p style="font-weight: bold;">${gerente}</p>
                            </div>
                            <div class="card-column">
                              <h4 style="color: #ccc;">Agente</h4>
                              <p style="font-weight: bold;">${agente}</p>
                            </div>
                          </div>

                          <div class="card-columns" style="margin-top: 8px;">
                         <div class="card-column">
  <h4>Status do Contrato:</h4>
  <p style="background: rgba(255,255,255,0.1); padding: 6px 10px; border-radius: 6px;">
    ${data.status_pagamento || "Aguardando assinatura"}
  </p>
  <button
    style="background-color: #928BFF; color: white; border: none; border-radius: 5px; padding: 6px 12px; font-size: 13px; cursor: pointer; opacity: 1; margin-top: 8px;"
    onclick="window.location.href='contrato.html?idSolicitacao=${
      data.id
    }&idCliente=${data.cliente_id}'"
  >
    Ver Contrato
  </button>
</div>

                       <div class="card-column">
  <h4>Status do Boleto:</h4>
  <p style="background: rgba(255,255,255,0.1); padding: 6px 10px; border-radius: 6px;">
    ${data.tipo_fatura || "Aguardando emissão"}
  </p>
  <button
    style="background-color: #928BFF; color: white; border: none; border-radius: 5px; padding: 6px 12px; font-size: 13px; cursor: pointer; opacity: 1; margin-top: 8px;"
    onclick="window.location.href='boletos.html?idSolicitacao=${
      data.id
    }&idCliente=${data.cliente_id}'"
  >
    Ver Boletos
  </button>
</div>

                          </div>

                          <div class="card-columns" style="margin-top: 16px;">
                            <div class="card-column">
                              <h4>Cadastro Aprovado</h4>
                                <button
    onclick="window.location.href='solicitar-custeio.html?idSolicitacao=${
      data.id
    }&idCliente=${data.cliente_id}&readonly=1'"
    style="background-color: #928BFF; color: white; border: none; border-radius: 5px; padding: 6px 12px; font-size: 13px; cursor: pointer; opacity: 1;">
    Ver Cadastro
  </button>
                            </div>
  <div class="card-column">
    <h4>Documentos Aprovados</h4>
    <button
      style="background-color: #928BFF; color: white; border: none; border-radius: 5px; padding: 6px 12px; font-size: 13px; cursor: pointer; opacity: 1;"
      onclick="window.location.href='upload-documentos.html?idSolicitacao=${
        data.id
      }&idCliente=${data.cliente_id}&aba=aprovados'">
      Ver Documentos
    </button>
  </div>

                          </div>

                          <div style="background-color: ${statusColor}; color: white; padding: 10px; border-radius: 8px; font-weight: bold; font-size: 13px; text-align: center; margin-top: 20px;">
                            ${data.status_solicitacao || "Concluído"}
                          </div>

                        </div>
                      </div>`;
            } else {
              // layout antigo
              card.innerHTML = `
          <div class="card-content" style="position: relative; background-image: url('assets/images/card.jpg'); background-size: cover; background-position: center; border-radius: 20px; padding: 24px;">
            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.4); border-radius: 20px;"></div>
            <div style="position: relative; z-index: 1;">
              <div class="card-header-top">
                <div class="card-logo">
                  <img src="assets/images/svg/homeLogo.png" alt="Logo" />
                </div>
                <div class="card-data">
                  <p>${
                    data.createdAt
                      ? new Date(
                          data.createdAt.seconds * 1000
                        ).toLocaleDateString("pt-BR")
                      : ""
                  }</p>
                </div>
                <div class="card-title-valor">
                  <h4>CRÉDITO DE CUSTEIO</h4>
                  <p>R$ ${Number(data.valor_credito || 0).toLocaleString(
                    "pt-BR",
                    {
                      minimumFractionDigits: 2,
                    }
                  )}</p>
                </div>
              </div>

              <div class="card-columns">
                <div class="card-column">
                  <h4>Completar Cadastro</h4>
                  <div style="width: 100%; background-color: #3a3a3a; border-radius: 6px; overflow: hidden; height: 12px; margin-bottom: 6px;">
                    <div style="width: 100%; background-color: #198754; height: 100%; transition: width 0.4s;"></div>
                  </div>
                  <p style="margin: 0; font-size: 12px; color: #ccc;">Verificação: ${
                    data.status_documentacao || "pendente"
                  }</p>
                                    <button
  onclick="window.location.href='solicitar-custeio.html?idSolicitacao=${
    data.id
  }'"
  style="
    background-color: #928BFF;
    color: white;
    border: none;
    border-radius: 5px;
    padding: 4px 10px;
    font-size: 12px;
    cursor: ${
      data.status_documentacao === "verificado" ||
      data.status_documentacao === "processando"
        ? "not-allowed"
        : "pointer"
    };
    opacity: ${
      data.status_documentacao === "verificado" ||
      data.status_documentacao === "processando"
        ? 0.5
        : 1
    };
  "
  ${
    data.status_documentacao === "verificado" ||
    data.status_documentacao === "processando"
      ? "disabled"
      : ""
  }
>
  Completar Cadastro
</button>


                </div>

                <div class="card-column">
                  <h4>Enviar Documentos</h4>
                  <div style="width: 100%; background-color: #3a3a3a; border-radius: 6px; overflow: hidden; height: 12px; margin-bottom: 6px;">
                    <div style="width: 100%; background-color: #198754; height: 100%; transition: width 0.4s;"></div>
                  </div>
                  <p style="margin: 0; font-size: 12px; color: #ccc;">Verificação: ${
                    data.status_documentacao || "pendente"
                  }</p>
                  <button
  class="btn-upload-documento"
  style="background-color: #928BFF; color: white; border: none; border-radius: 5px; padding: 4px 10px; font-size: 12px; cursor: ${
    data.status_documentacao === "verificado" ||
    data.status_documentacao === "processando"
      ? "not-allowed"
      : "pointer"
  }; opacity: ${
                data.status_documentacao === "verificado" ||
                data.status_documentacao === "processando"
                  ? 0.5
                  : 1
              };"
  ${
    data.status_documentacao === "verificado" ||
    data.status_documentacao === "processando"
      ? "disabled"
      : ""
  }
  onclick="window.location.href='upload-documentos.html?idSolicitacao=${
    data.id
  }&idCliente=${data.cliente_id}'"
>
  Enviar Documentos
</button>


                </div>
              </div>

              <div style="background-color: ${statusColor}; color: white; padding: 6px 12px; border-radius: 8px; font-weight: bold; font-size: 13px; text-align: center; margin-top: 16px;">
                ${data.status_solicitacao || "Aguardando Documentação"}
              </div>
            </div>
          </div>`;
            }

            cardsContainer.appendChild(card);
          });
        }

        function ordenarPorDataDesc(lista) {
          return lista.sort((a, b) => {
            const dataA = a.data_solicitacao?.toDate?.() || new Date(0);
            const dataB = b.data_solicitacao?.toDate?.() || new Date(0);
            return dataB - dataA;
          });
        }

        document
          .querySelector('[data-tab="one"]')
          .addEventListener("click", () => {
            document
              .querySelectorAll(".ongoing")
              .forEach((btn) => btn.classList.remove("tab-active"));
            document
              .querySelector('[data-tab="one"]')
              .classList.add("tab-active");

            const filtradas = todasSolicitacoes.filter((s) => {
              const status = (s.status_solicitacao || "").toLowerCase();
              return status !== "concluido" && status !== "aprovado";
            });

            renderizarCards(ordenarPorDataDesc(filtradas));
          });

        document
          .querySelector('[data-tab="two"]')
          .addEventListener("click", () => {
            document
              .querySelectorAll(".ongoing")
              .forEach((btn) => btn.classList.remove("tab-active"));
            document
              .querySelector('[data-tab="two"]')
              .classList.add("tab-active");

            const filtradas = todasSolicitacoes.filter((s) => {
              const status = (s.status_solicitacao || "").toLowerCase();
              return status === "concluido" || status === "aprovado";
            });

            renderizarCards(ordenarPorDataDesc(filtradas));
          });

        document.querySelector('[data-tab="one"]').click();
      });
    </script>
  </body>
</html>
